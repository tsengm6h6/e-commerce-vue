{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es.object.values.js","webpack:///./src/components/Order.vue?3dea","webpack:///./src/views/Orders.vue?8e62","webpack:///src/views/Orders.vue","webpack:///./src/views/Orders.vue?c7a6","webpack:///./src/views/Orders.vue","webpack:///./node_modules/core-js/internals/object-to-array.js","webpack:///./src/utils/mixin.js","webpack:///./src/views/Orders.vue?3f62","webpack:///./src/components/Order.vue?281d","webpack:///src/components/Order.vue","webpack:///./src/components/Order.vue?d8da","webpack:///./src/components/Order.vue"],"names":["$","$values","values","target","stat","O","render","_vm","this","_h","$createElement","_c","_self","attrs","staticClass","_v","staticStyle","orders","scopedSlots","_u","key","fn","props","row","id","on","afterPayOrder","text","value","filterTag","scope","isPaid","_s","pagination","total_pages","current_page","$event","$set","handlePageChange","staticRenderFns","name","components","Order","Loading","Breadcrumb","metaInfo","title","data","isLoading","currOrderId","mixins","mixin","methods","fetchOrders","page","$router","push","path","query","created","component","DESCRIPTORS","objectKeys","toIndexedObject","propertyIsEnumerable","f","createMethod","TO_ENTRIES","it","keys","length","i","result","call","module","exports","entries","dateFormat","timestamp","formattedDate","Date","yyyy","getFullYear","mm","getMonth","dd","getDate","orderIsPaid","showPayBtn","payOrder","_e","orderList","userEmail","userTel","userAddress","productsList","type","String","require","fromCheckout","Boolean","computed","fetchOrder"],"mappings":"qGAAA,IAAIA,EAAI,EAAQ,QACZC,EAAU,EAAQ,QAAgCC,OAItDF,EAAE,CAAEG,OAAQ,SAAUC,MAAM,GAAQ,CAClCF,OAAQ,SAAgBG,GACtB,OAAOJ,EAAQI,O,oCCPnB,W,2CCAA,IAAIC,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,eAAe,CAACE,MAAM,CAAC,UAAY,aAAa,CAAEN,EAAa,UAAEI,EAAG,WAAW,CAACA,EAAG,MAAM,CAACG,YAAY,SAAS,CAACH,EAAG,KAAK,CAACJ,EAAIQ,GAAG,UAAUJ,EAAG,IAAI,CAACJ,EAAIQ,GAAG,qBAAqBJ,EAAG,aAAa,CAACG,YAAY,eAAeH,EAAG,SAAS,CAACA,EAAG,SAAS,CAACE,MAAM,CAAC,KAAO,KAAK,CAACF,EAAG,WAAW,CAACK,YAAY,CAAC,MAAQ,QAAQH,MAAM,CAAC,OAAS,GAAG,KAAON,EAAIU,SAAS,CAACN,EAAG,kBAAkB,CAACE,MAAM,CAAC,KAAO,UAAUK,YAAYX,EAAIY,GAAG,CAAC,CAACC,IAAI,UAAUC,GAAG,SAASC,GAAO,MAAO,CAACX,EAAG,QAAQ,CAACE,MAAM,CAAC,YAAcS,EAAMC,IAAIC,IAAIC,GAAG,CAAC,kBAAkBlB,EAAImB,wBAAwBf,EAAG,kBAAkB,CAACE,MAAM,CAAC,YAAY,MAAM,MAAQ,KAAK,KAAO,YAAY,MAAQ,YAAYF,EAAG,kBAAkB,CAACE,MAAM,CAAC,YAAY,MAAM,MAAQ,OAAO,KAAO,KAAK,MAAQ,YAAYF,EAAG,kBAAkB,CAACE,MAAM,CAAC,KAAO,SAAS,MAAQ,OAAO,YAAY,MAAM,MAAQ,SAAS,QAAU,CACx6B,CAAEc,KAAM,MAAOC,OAAO,GACtB,CAAED,KAAM,OAAQC,OAAO,IAAU,gBAAgBrB,EAAIsB,WAAWX,YAAYX,EAAIY,GAAG,CAAC,CAACC,IAAI,UAAUC,GAAG,SAASS,GAAO,MAAO,CAACnB,EAAG,SAAS,CAACE,MAAM,CAAC,KAAO,QAAQ,KAAOiB,EAAMP,IAAIQ,OAAS,OAAS,SAAS,sBAAsB,KAAK,CAACxB,EAAIQ,GAAGR,EAAIyB,GAAGF,EAAMP,IAAIQ,OAAS,MAAQ,kBAAkBpB,EAAG,kBAAkB,CAACE,MAAM,CAAC,YAAY,MAAM,MAAQ,KAAK,KAAO,QAAQ,MAAQ,YAAYF,EAAG,kBAAkB,CAACE,MAAM,CAAC,YAAY,MAAM,MAAQ,MAAM,KAAO,WAAW,MAAQ,aAAa,GAAGF,EAAG,SAAS,CAACG,YAAY,SAASD,MAAM,CAAC,KAAO,OAAO,QAAU,WAAW,CAACF,EAAG,gBAAgB,CAACE,MAAM,CAAC,aAAaN,EAAI0B,WAAWC,YAAY,eAAe3B,EAAI0B,WAAWE,aAAa,OAAS,qBAAqBV,GAAG,CAAC,qBAAqB,SAASW,GAAQ,OAAO7B,EAAI8B,KAAK9B,EAAI0B,WAAY,eAAgBG,IAAS,sBAAsB,SAASA,GAAQ,OAAO7B,EAAI8B,KAAK9B,EAAI0B,WAAY,eAAgBG,IAAS,iBAAiB7B,EAAI+B,qBAAqB,IAAI,IAAI,KAAK,IACv8BC,EAAkB,G,oHCsFtB,GACEC,KAAM,SACNC,WAAY,CACVC,MAAJ,OACIC,QAAJ,OACIC,WAAJ,QAEEC,SAAU,CACRC,MAAO,QAETC,KAVF,WAWI,MAAO,CACL9B,OAAQ,GACRgB,WAAY,GACZe,WAAW,EACXC,YAAa,KAGjBC,OAAQ,CAACC,EAAX,MACEC,QAAS,CACP,YADJ,WACA,+NAEA,eAFA,SAGA,oBAHA,UAGA,EAHA,QAIA,mBAJA,sBAKA,UALA,OAOA,4CAEA,EAMA,EANA,UACA,EAKA,EALA,GACA,EAIA,EAJA,QACA,EAGA,EAHA,IACA,EAEA,EAFA,MACA,EACA,EADA,KAEA,OACA,0BACA,KACA,SACA,MACA,QACA,0BAGA,kDACA,eA1BA,qDA4BA,mCACA,eA7BA,6DAgCId,iBAjCJ,SAiCA,GACM9B,KAAK6C,YAAYC,GACjB9C,KAAK+C,QAAQC,KAAK,CAChBC,KAAM,UACNC,MAAO,CACLJ,KAAMA,MAIZzB,UA1CJ,SA0CA,KACM,OAAON,EAAIQ,SAAWH,GAExBF,cA7CJ,WA6CA,IACA,yBACMlB,KAAK6C,YAAYC,KAGrBK,QArEF,WAqEA,IACA,yBACInD,KAAK6C,YAAYC,KChK2T,I,wBCQ5UM,EAAY,eACd,EACAtD,EACAiC,GACA,EACA,KACA,WACA,MAIa,aAAAqB,E,yDCnBf,IAAIC,EAAc,EAAQ,QACtBC,EAAa,EAAQ,QACrBC,EAAkB,EAAQ,QAC1BC,EAAuB,EAAQ,QAA8CC,EAG7EC,EAAe,SAAUC,GAC3B,OAAO,SAAUC,GACf,IAKIhD,EALAf,EAAI0D,EAAgBK,GACpBC,EAAOP,EAAWzD,GAClBiE,EAASD,EAAKC,OACdC,EAAI,EACJC,EAAS,GAEb,MAAOF,EAASC,EACdnD,EAAMiD,EAAKE,KACNV,IAAeG,EAAqBS,KAAKpE,EAAGe,IAC/CoD,EAAOhB,KAAKW,EAAa,CAAC/C,EAAKf,EAAEe,IAAQf,EAAEe,IAG/C,OAAOoD,IAIXE,EAAOC,QAAU,CAGfC,QAASV,GAAa,GAGtBhE,OAAQgE,GAAa,K,4CC9BR,QACbd,QAAS,CACPyB,WADO,SACKC,GACV,IAAMC,EAAgB,IAAIC,KAAiB,IAAZF,GACzBG,EAAOF,EAAcG,cACrBC,GACHJ,EAAcK,WAAa,EAAI,GAAK,IAAM,KAAOL,EAAcK,WAAa,GACzEC,GAAMN,EAAcO,UAAY,GAAK,IAAM,IAAMP,EAAcO,UACrE,gBAAUL,EAAV,YAAkBE,EAAlB,YAAwBE,O,yDCR9B,W,kCCAA,IAAI/E,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAQF,EAAa,UAAEI,EAAG,WAAWA,EAAG,MAAM,CAACA,EAAG,eAAe,CAACA,EAAG,KAAK,CAACJ,EAAIQ,GAAG,QAAQR,EAAIyB,GAAGzB,EAAI0C,iBAAkB1C,EAAIgF,aAAehF,EAAIiF,WAAY7E,EAAG,YAAY,CAACE,MAAM,CAAC,KAAO,UAAU,KAAO,QAAQ,QAAUN,EAAIyC,WAAWvB,GAAG,CAAC,MAAQ,SAASW,GAAQ,OAAO7B,EAAIkF,SAASlF,EAAI0C,gBAAgB,CAAC1C,EAAIQ,GAAG,UAAUR,EAAImF,MAAM,GAAG/E,EAAG,cAAcA,EAAG,IAAI,CAACG,YAAY,SAAS,CAACP,EAAIQ,GAAG,WAAWJ,EAAG,WAAW,CAACK,YAAY,CAAC,MAAQ,QAAQH,MAAM,CAAC,KAAON,EAAIoF,YAAY,CAAChF,EAAG,kBAAkB,CAACE,MAAM,CAAC,KAAO,UAAUK,YAAYX,EAAIY,GAAG,CAAC,CAACC,IAAI,UAAUC,GAAG,SAASC,GAAO,MAAO,CAACX,EAAG,IAAI,CAACJ,EAAIQ,GAAG,MAAMR,EAAIyB,GAAGV,EAAMC,IAAIqE,cAAcjF,EAAG,IAAI,CAACJ,EAAIQ,GAAG,MAAMR,EAAIyB,GAAGV,EAAMC,IAAIsE,YAAYlF,EAAG,IAAI,CAACJ,EAAIQ,GAAG,MAAMR,EAAIyB,GAAGV,EAAMC,IAAIuE,uBAAuBnF,EAAG,kBAAkB,CAACE,MAAM,CAAC,MAAQ,QAAQ,KAAO,WAAW,YAAY,SAASF,EAAG,kBAAkB,CAACE,MAAM,CAAC,MAAQ,OAAO,KAAO,YAAY,YAAY,SAASF,EAAG,kBAAkB,CAACE,MAAM,CAAC,MAAQ,OAAO,KAAO,SAAS,YAAY,SAASF,EAAG,kBAAkB,CAACE,MAAM,CAAC,MAAQ,MAAM,KAAO,WAAW,YAAY,UAAU,GAAGF,EAAG,MAAM,CAACG,YAAY,cAAc,CAACH,EAAG,IAAI,CAACG,YAAY,SAAS,CAACP,EAAIQ,GAAG,UAAUJ,EAAG,WAAW,CAACK,YAAY,CAAC,MAAQ,QAAQH,MAAM,CAAC,KAAON,EAAIwF,eAAe,CAACpF,EAAG,kBAAkB,CAACE,MAAM,CAAC,KAAO,cAAc,MAAQ,OAAO,MAAQ,SAASF,EAAG,kBAAkB,CAACE,MAAM,CAAC,KAAO,MAAM,MAAQ,KAAK,YAAY,QAAQF,EAAG,kBAAkB,CAACE,MAAM,CAAC,KAAO,cAAc,MAAQ,KAAK,YAAY,QAAQF,EAAG,kBAAkB,CAACE,MAAM,CAAC,KAAO,cAAc,MAAQ,KAAK,YAAY,SAASF,EAAG,kBAAkB,CAACE,MAAM,CAAC,KAAO,WAAW,MAAQ,QAAQ,YAAY,UAAU,IAAI,IAAI,IAChtD0B,EAAkB,G,kHC8DtB,GACEC,KAAM,QACNlB,MAAO,CACL2B,YAAa,CACX+C,KAAMC,OACNC,SAAS,GAEXC,aAAc,CACZH,KAAMI,QACNF,SAAS,IAGbhD,OAAQ,CAACC,EAAX,MACEV,WAAY,CACVE,QAAJ,QAEEI,KAhBF,WAiBI,MAAO,CACLwC,aAAa,EACbI,UAAW,GACXI,aAAc,GACdP,YAAY,IAGhBa,SAAU,OAAZ,OAAY,CAAZ,GACA,+BAEEjD,QAAS,CACP,WADJ,SACA,+LAEA,iCAFA,SAGA,mBAHA,UAGA,EAHA,QAIA,mBAJA,sBAKA,UALA,SAcA,aANA,EARA,EAQA,UACA,EATA,EASA,GACA,EAVA,EAUA,QACA,EAXA,EAWA,SACA,EAZA,EAYA,MACA,EAbA,EAaA,KAGA,gBACA,eACA,gBAEA,gBAEA,kBACA,KACA,0BACA,sBACA,WACA,sBACA,wBACA,4BACA,sBAEA,wDACA,2BACA,UACA,4BACA,4BACA,+BAEA,iCACA,sBAxCA,qDA0CA,iCACA,iCA3CA,6DA8CI,SA/CJ,SA+CA,iLAEA,iCAFA,SAGA,mBAHA,UAGA,EAHA,QAIA,mBAJA,sBAKA,UALA,OAOA,iFACA,GADA,IAEA,kBAEA,iBACA,iCACA,2BAbA,qDAeA,iCACA,iCAhBA,8DAoBEO,QA9FF,WA+FInD,KAAK8F,WAAW9F,KAAKyC,eC9JsT,I,wBCQ3UW,EAAY,eACd,EACAtD,EACAiC,GACA,EACA,KACA,WACA,MAIa,OAAAqB,E","file":"js/chunk-50aa5260.b3de30d7.js","sourcesContent":["var $ = require('../internals/export');\nvar $values = require('../internals/object-to-array').values;\n\n// `Object.values` method\n// https://tc39.es/ecma262/#sec-object.values\n$({ target: 'Object', stat: true }, {\n  values: function values(O) {\n    return $values(O);\n  }\n});\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Order.vue?vue&type=style&index=0&id=4363b629&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-container',{attrs:{\"direction\":\"vertical\"}},[(_vm.isLoading)?_c('Loading'):[_c('div',{staticClass:\"title\"},[_c('h3',[_vm._v(\"訂單列表\")]),_c('p',[_vm._v(\"如有任何問題，請洽專人客服\")])]),_c('Breadcrumb',{staticClass:\"breadcrumb\"}),_c('el-row',[_c('el-col',{attrs:{\"span\":24}},[_c('el-table',{staticStyle:{\"width\":\"100%\"},attrs:{\"stripe\":\"\",\"data\":_vm.orders}},[_c('el-table-column',{attrs:{\"type\":\"expand\"},scopedSlots:_vm._u([{key:\"default\",fn:function(props){return [_c('Order',{attrs:{\"currOrderId\":props.row.id},on:{\"after-pay-order\":_vm.afterPayOrder}})]}}])}),_c('el-table-column',{attrs:{\"min-width\":\"100\",\"label\":\"日期\",\"prop\":\"createdAt\",\"align\":\"center\"}}),_c('el-table-column',{attrs:{\"min-width\":\"200\",\"label\":\"訂單編號\",\"prop\":\"id\",\"align\":\"center\"}}),_c('el-table-column',{attrs:{\"prop\":\"isPaid\",\"label\":\"付款狀態\",\"min-width\":\"100\",\"align\":\"center\",\"filters\":[\n              { text: '已付款', value: true },\n              { text: '尚未付款', value: false } ],\"filter-method\":_vm.filterTag},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-tag',{attrs:{\"size\":\"small\",\"type\":scope.row.isPaid ? 'info' : 'danger',\"disable-transitions\":\"\"}},[_vm._v(_vm._s(scope.row.isPaid ? \"已付款\" : \"尚未付款\"))])]}}])}),_c('el-table-column',{attrs:{\"min-width\":\"100\",\"label\":\"總計\",\"prop\":\"total\",\"align\":\"center\"}}),_c('el-table-column',{attrs:{\"min-width\":\"100\",\"label\":\"訂購人\",\"prop\":\"userName\",\"align\":\"center\"}})],1),_c('el-row',{staticClass:\"row-bg\",attrs:{\"type\":\"flex\",\"justify\":\"center\"}},[_c('el-pagination',{attrs:{\"page-count\":_vm.pagination.total_pages,\"current-page\":_vm.pagination.current_page,\"layout\":\"prev, pager, next\"},on:{\"update:currentPage\":function($event){return _vm.$set(_vm.pagination, \"current_page\", $event)},\"update:current-page\":function($event){return _vm.$set(_vm.pagination, \"current_page\", $event)},\"current-change\":_vm.handlePageChange}})],1)],1)],1)]],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <el-container direction=\"vertical\">\r\n    <Loading v-if=\"isLoading\" />\r\n    <template v-else>\r\n      <div class=\"title\">\r\n        <h3>訂單列表</h3>\r\n        <p>如有任何問題，請洽專人客服</p>\r\n      </div>\r\n      <Breadcrumb class=\"breadcrumb\" />\r\n      <el-row>\r\n        <el-col :span=\"24\">\r\n          <el-table stripe :data=\"orders\" style=\"width: 100%\">\r\n            <el-table-column type=\"expand\">\r\n              <template slot-scope=\"props\">\r\n                <Order\r\n                  :currOrderId=\"props.row.id\"\r\n                  @after-pay-order=\"afterPayOrder\"\r\n                />\r\n              </template>\r\n            </el-table-column>\r\n\r\n            <el-table-column\r\n              min-width=\"100\"\r\n              label=\"日期\"\r\n              prop=\"createdAt\"\r\n              align=\"center\"\r\n            ></el-table-column>\r\n            <el-table-column\r\n              min-width=\"200\"\r\n              label=\"訂單編號\"\r\n              prop=\"id\"\r\n              align=\"center\"\r\n            ></el-table-column>\r\n            <el-table-column\r\n              prop=\"isPaid\"\r\n              label=\"付款狀態\"\r\n              min-width=\"100\"\r\n              align=\"center\"\r\n              :filters=\"[\r\n                { text: '已付款', value: true },\r\n                { text: '尚未付款', value: false },\r\n              ]\"\r\n              :filter-method=\"filterTag\"\r\n            >\r\n              <template slot-scope=\"scope\">\r\n                <el-tag\r\n                  size=\"small\"\r\n                  :type=\"scope.row.isPaid ? 'info' : 'danger'\"\r\n                  disable-transitions\r\n                  >{{ scope.row.isPaid ? \"已付款\" : \"尚未付款\" }}</el-tag\r\n                >\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n              min-width=\"100\"\r\n              label=\"總計\"\r\n              prop=\"total\"\r\n              align=\"center\"\r\n            ></el-table-column>\r\n            <el-table-column\r\n              min-width=\"100\"\r\n              label=\"訂購人\"\r\n              prop=\"userName\"\r\n              align=\"center\"\r\n            ></el-table-column>\r\n          </el-table>\r\n          <!-- Pagination -->\r\n          <el-row type=\"flex\" class=\"row-bg\" justify=\"center\">\r\n            <el-pagination\r\n              :page-count=\"pagination.total_pages\"\r\n              :current-page.sync=\"pagination.current_page\"\r\n              @current-change=\"handlePageChange\"\r\n              layout=\"prev, pager, next\"\r\n            >\r\n            </el-pagination>\r\n          </el-row>\r\n        </el-col>\r\n      </el-row>\r\n    </template>\r\n  </el-container>\r\n</template>\r\n\r\n<script>\r\nimport Order from '../components/Order.vue'\r\nimport customerAPI from '../apis/customer.js'\r\nimport mixin from '../utils/mixin.js'\r\nimport Loading from '../components/Loading.vue'\r\nimport Breadcrumb from '../components/Breadcrumb.vue'\r\n\r\nexport default {\r\n  name: 'orders',\r\n  components: {\r\n    Order,\r\n    Loading,\r\n    Breadcrumb\r\n  },\r\n  metaInfo: {\r\n    title: '我的訂單'\r\n  },\r\n  data () {\r\n    return {\r\n      orders: [],\r\n      pagination: {},\r\n      isLoading: false,\r\n      currOrderId: ''\r\n    }\r\n  },\r\n  mixins: [mixin],\r\n  methods: {\r\n    async fetchOrders (page = 1) {\r\n      try {\r\n        this.isLoading = true\r\n        const response = await customerAPI.getOrders(page)\r\n        if (response.data.success !== true) {\r\n          throw new Error()\r\n        }\r\n        this.orders = response.data.orders.map((item) => {\r\n          const {\r\n            create_at: createdAt,\r\n            id,\r\n            is_paid: isPaid,\r\n            num,\r\n            total,\r\n            user\r\n          } = item\r\n          return {\r\n            createdAt: this.dateFormat(createdAt),\r\n            id,\r\n            isPaid,\r\n            num,\r\n            total,\r\n            userName: user ? user.name : '-'\r\n          }\r\n        })\r\n        this.pagination = { ...response.data.pagination }\r\n        this.isLoading = false\r\n      } catch (error) {\r\n        this.$message.error('無法取得訂單列表，請稍後再試')\r\n        this.isLoading = false\r\n      }\r\n    },\r\n    handlePageChange (page) {\r\n      this.fetchOrders(page)\r\n      this.$router.push({\r\n        path: '/orders',\r\n        query: {\r\n          page: page\r\n        }\r\n      })\r\n    },\r\n    filterTag (value, row) {\r\n      return row.isPaid === value\r\n    },\r\n    afterPayOrder () {\r\n      const { page } = this.$route.query\r\n      this.fetchOrders(page)\r\n    }\r\n  },\r\n  created () {\r\n    const { page } = this.$route.query\r\n    this.fetchOrders(page)\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.el-container {\r\n  padding: 30px;\r\n}\r\n\r\n.breadcrumb {\r\n  margin-left: 10px;\r\n}\r\n\r\n.title {\r\n  width: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n  margin-bottom: 30px;\r\n  letter-spacing: 1px;\r\n}\r\n\r\n.title h3 {\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.el-pagination {\r\n  margin-top: 30px;\r\n}\r\n\r\n.el-breadcrumb {\r\n  margin-left: 10px;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.el-checkbox__label,\r\n.el-table-filter__bottom button {\r\n  font-size: 14px;\r\n}\r\n\r\n/* sm */\r\n@media only screen and (min-width: 768px) {\r\n  .el-container {\r\n    padding: 30px 80px;\r\n  }\r\n}\r\n\r\n/* md */\r\n@media only screen and (min-width: 992px) {\r\n  .el-container {\r\n    padding: 30px 120px;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Orders.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Orders.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Orders.vue?vue&type=template&id=65b0088e&scoped=true&\"\nimport script from \"./Orders.vue?vue&type=script&lang=js&\"\nexport * from \"./Orders.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Orders.vue?vue&type=style&index=0&id=65b0088e&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"65b0088e\",\n  null\n  \n)\n\nexport default component.exports","var DESCRIPTORS = require('../internals/descriptors');\nvar objectKeys = require('../internals/object-keys');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar propertyIsEnumerable = require('../internals/object-property-is-enumerable').f;\n\n// `Object.{ entries, values }` methods implementation\nvar createMethod = function (TO_ENTRIES) {\n  return function (it) {\n    var O = toIndexedObject(it);\n    var keys = objectKeys(O);\n    var length = keys.length;\n    var i = 0;\n    var result = [];\n    var key;\n    while (length > i) {\n      key = keys[i++];\n      if (!DESCRIPTORS || propertyIsEnumerable.call(O, key)) {\n        result.push(TO_ENTRIES ? [key, O[key]] : O[key]);\n      }\n    }\n    return result;\n  };\n};\n\nmodule.exports = {\n  // `Object.entries` method\n  // https://tc39.es/ecma262/#sec-object.entries\n  entries: createMethod(true),\n  // `Object.values` method\n  // https://tc39.es/ecma262/#sec-object.values\n  values: createMethod(false)\n};\n","export default {\r\n  methods: {\r\n    dateFormat (timestamp) {\r\n      const formattedDate = new Date(timestamp * 1000)\r\n      const yyyy = formattedDate.getFullYear()\r\n      const mm =\r\n        (formattedDate.getMonth() + 1 < 10 ? '0' : '') + (formattedDate.getMonth() + 1)\r\n      const dd = (formattedDate.getDate() < 10 ? '0' : '') + formattedDate.getDate()\r\n      return `${yyyy}-${mm}-${dd}`\r\n    }\r\n  }\r\n}\r\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Orders.vue?vue&type=style&index=0&id=65b0088e&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.isLoading)?_c('Loading'):_c('div',[_c('el-container',[_c('h4',[_vm._v(\"訂單編號：\"+_vm._s(_vm.currOrderId))]),(!_vm.orderIsPaid && _vm.showPayBtn)?_c('el-button',{attrs:{\"type\":\"warning\",\"size\":\"small\",\"loading\":_vm.isLoading},on:{\"click\":function($event){return _vm.payOrder(_vm.currOrderId)}}},[_vm._v(\"確認付款\")]):_vm._e()],1),_c('el-divider'),_c('p',{staticClass:\"title\"},[_vm._v(\"訂購人資訊\")]),_c('el-table',{staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.orderList}},[_c('el-table-column',{attrs:{\"type\":\"expand\"},scopedSlots:_vm._u([{key:\"default\",fn:function(props){return [_c('p',[_vm._v(\"信箱：\"+_vm._s(props.row.userEmail))]),_c('p',[_vm._v(\"電話：\"+_vm._s(props.row.userTel))]),_c('p',[_vm._v(\"地址：\"+_vm._s(props.row.userAddress))])]}}])}),_c('el-table-column',{attrs:{\"label\":\"訂購人資訊\",\"prop\":\"userName\",\"min-width\":\"180\"}}),_c('el-table-column',{attrs:{\"label\":\"訂購日期\",\"prop\":\"orderDate\",\"min-width\":\"100\"}}),_c('el-table-column',{attrs:{\"label\":\"訂單狀態\",\"prop\":\"isPaid\",\"min-width\":\"100\"}}),_c('el-table-column',{attrs:{\"label\":\"總金額\",\"prop\":\"orderSum\",\"min-width\":\"100\"}})],1),_c('div',{staticClass:\"order-info\"},[_c('p',{staticClass:\"title\"},[_vm._v(\"訂單明細\")]),_c('el-table',{staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.productsList}},[_c('el-table-column',{attrs:{\"prop\":\"productName\",\"label\":\"商品名稱\",\"width\":\"180\"}}),_c('el-table-column',{attrs:{\"prop\":\"qty\",\"label\":\"數量\",\"min-width\":\"50\"}}),_c('el-table-column',{attrs:{\"prop\":\"productUnit\",\"label\":\"單位\",\"min-width\":\"50\"}}),_c('el-table-column',{attrs:{\"prop\":\"originPrice\",\"label\":\"單價\",\"min-width\":\"100\"}}),_c('el-table-column',{attrs:{\"prop\":\"isCoupon\",\"label\":\"套用優惠券\",\"min-width\":\"100\"}})],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <Loading v-if=\"isLoading\" />\r\n  <div v-else>\r\n    <el-container>\r\n      <h4>訂單編號：{{ currOrderId }}</h4>\r\n      <el-button\r\n        v-if=\"!orderIsPaid && showPayBtn\"\r\n        @click=\"payOrder(currOrderId)\"\r\n        type=\"warning\"\r\n        size=\"small\"\r\n        :loading=\"isLoading\"\r\n        >確認付款</el-button\r\n      >\r\n    </el-container>\r\n    <el-divider></el-divider>\r\n    <p class=\"title\">訂購人資訊</p>\r\n    <el-table :data=\"orderList\" style=\"width: 100%\">\r\n      <el-table-column type=\"expand\">\r\n        <template slot-scope=\"props\">\r\n          <p>信箱：{{ props.row.userEmail }}</p>\r\n          <p>電話：{{ props.row.userTel }}</p>\r\n          <p>地址：{{ props.row.userAddress }}</p>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column\r\n        label=\"訂購人資訊\"\r\n        prop=\"userName\"\r\n        min-width=\"180\"\r\n      ></el-table-column>\r\n      <el-table-column label=\"訂購日期\" prop=\"orderDate\" min-width=\"100\">\r\n      </el-table-column>\r\n      <el-table-column label=\"訂單狀態\" prop=\"isPaid\" min-width=\"100\">\r\n      </el-table-column>\r\n      <el-table-column\r\n        label=\"總金額\"\r\n        prop=\"orderSum\"\r\n        min-width=\"100\"\r\n      ></el-table-column>\r\n    </el-table>\r\n    <div class=\"order-info\">\r\n      <p class=\"title\">訂單明細</p>\r\n      <el-table :data=\"productsList\" style=\"width: 100%\">\r\n        <el-table-column prop=\"productName\" label=\"商品名稱\" width=\"180\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"qty\" label=\"數量\" min-width=\"50\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"productUnit\" label=\"單位\" min-width=\"50\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"originPrice\" label=\"單價\" min-width=\"100\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"isCoupon\" label=\"套用優惠券\" min-width=\"100\">\r\n        </el-table-column>\r\n      </el-table>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport customerAPI from '../apis/customer.js'\r\nimport mixin from '../utils/mixin.js'\r\nimport { mapState } from 'vuex'\r\nimport Loading from '../components/Loading.vue'\r\n\r\nexport default {\r\n  name: 'Order',\r\n  props: {\r\n    currOrderId: {\r\n      type: String,\r\n      require: true\r\n    },\r\n    fromCheckout: {\r\n      type: Boolean,\r\n      require: true\r\n    }\r\n  },\r\n  mixins: [mixin],\r\n  components: {\r\n    Loading\r\n  },\r\n  data () {\r\n    return {\r\n      orderIsPaid: false,\r\n      orderList: [],\r\n      productsList: [],\r\n      showPayBtn: false\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapState(['isLoading'])\r\n  },\r\n  methods: {\r\n    async fetchOrder (orderId) {\r\n      try {\r\n        this.$store.commit('setLoading', true)\r\n        const response = await customerAPI.getOrder(orderId)\r\n        if (response.data.success !== true) {\r\n          throw new Error()\r\n        }\r\n        const {\r\n          create_at: createdAt,\r\n          id,\r\n          is_paid: isPaid,\r\n          products,\r\n          total,\r\n          user\r\n        } = response.data.order\r\n\r\n        this.orderIsPaid = isPaid\r\n        if (this.fromCheckout) {\r\n          this.showPayBtn = false\r\n        } else {\r\n          this.showPayBtn = !isPaid\r\n        }\r\n        this.orderList.push({\r\n          id,\r\n          orderDate: this.dateFormat(createdAt),\r\n          isPaid: isPaid ? '已付款' : '尚未付款',\r\n          orderSum: total,\r\n          userName: user ? user.name : '-',\r\n          userEmail: user ? user.email : '-',\r\n          userAddress: user ? user.address : '-',\r\n          userTel: user ? user.tel : '-'\r\n        })\r\n        this.productsList = Object.values(products).map((item) => ({\r\n          isCoupon: item.coupon ? '已套用' : '',\r\n          qty: item.qty,\r\n          originPrice: item.product.price,\r\n          productName: item.product.title,\r\n          productUnit: item.product.unit\r\n        }))\r\n        this.$store.commit('setLoading', false)\r\n        this.$emit('openDialog')\r\n      } catch (error) {\r\n        this.$message.error('無法取得訂單，請稍後再試')\r\n        this.$store.commit('setLoading', false)\r\n      }\r\n    },\r\n    async payOrder (orderId) {\r\n      try {\r\n        this.$store.commit('setLoading', true)\r\n        const response = await customerAPI.payOrder(orderId)\r\n        if (response.data.success !== true) {\r\n          throw new Error()\r\n        }\r\n        this.orderList = this.orderList.map((item) => ({\r\n          ...item,\r\n          isPaid: '已付款'\r\n        }))\r\n        this.orderIsPaid = true\r\n        this.$store.commit('setLoading', false)\r\n        this.$emit('after-pay-order')\r\n      } catch (error) {\r\n        this.$message.error('無法完成付款，請稍後再試')\r\n        this.$store.commit('setLoading', false)\r\n      }\r\n    }\r\n  },\r\n  created () {\r\n    this.fetchOrder(this.currOrderId)\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.el-button {\r\n  margin-left: 10px;\r\n}\r\n\r\nh4,\r\n.title {\r\n  letter-spacing: 2px;\r\n  font-weight: 500;\r\n}\r\n\r\n.title {\r\n  line-height: 24px;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.order-info {\r\n  margin-top: 30px;\r\n}\r\n\r\n.el-table th > .cell {\r\n  letter-spacing: 3px;\r\n  font-weight: 500;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Order.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Order.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Order.vue?vue&type=template&id=4363b629&scoped=true&\"\nimport script from \"./Order.vue?vue&type=script&lang=js&\"\nexport * from \"./Order.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Order.vue?vue&type=style&index=0&id=4363b629&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4363b629\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}